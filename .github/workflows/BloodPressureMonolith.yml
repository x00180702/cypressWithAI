name: Blood Pressure Monolith yml
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '13 9-18 * * *'
jobs:
  install:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code ðŸ›Ž
        uses: actions/checkout@v2
      - name: Install dependencies ðŸ“¦
        uses: cypress-io/github-action@v2
        with:
          # just perform install
          runTests: false
  
  tests2:        
    runs-on: ubuntu-20.04
    needs: install
    steps:
      - name: Check out code ðŸ›Ž
        uses: actions/checkout@v2
      # we re-install the dependencies
      # in practice, this should pull the cached
      # dependencies from the previous install job
      - name: Install dependencies ðŸ“¦
        uses: cypress-io/github-action@v2
        with:
          # just perform install
          runTests: false
          #record: true

      - name: Run tests with "@bpTest" ðŸ§ª
        run: |
         npx cypress run --headless --env tags="@bpTest"
       # npx cypress run --record --key b877676e-70aa-40b3-84da-261dcc19e396 --env tags="@bpTest"

      - name: Merge test results into one
        run: npm run report:merge
      
      - name: Generate HTML report
        run: npm run report:generate
      
      - name: Deploy report page
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
